<apex:page Controller="Opp_NV_tabListados" title="Notas de Venda" tabStyle="Opportunity">
    <apex:sectionHeader title="Notas de Venda" subtitle="NV de Brasmax" ></apex:sectionHeader>
    <apex:pageBlock title="Pesquisa de Notas de Venda">
        <apex:form >
            <apex:outputLabel value="Tipo de NV:  "></apex:outputLabel> 
            <apex:selectList value="{!rt}" size="1" required="true"><apex:selectOptions value="{!RTypes}"/></apex:selectList>
            <apex:outputLabel value="Critério:  "></apex:outputLabel>
            <apex:inputText value="{!searchText}"></apex:inputText>
            <apex:outputLabel value="Responsavel:  "></apex:outputLabel>
            <apex:inputField value="{!ac.Responsavel__c}"></apex:inputField>
            <apex:outputLabel value="Safra:  "></apex:outputLabel>
            <apex:inputField value="{!opp.Safra__c}"></apex:inputField>
            <apex:commandButton action="{!listar}" value="Pesquisar" id="searchBtn" rerender="acclist" status="status"/>
            <apex:actionStatus startText="Consultando..." id="status"/>
        </apex:form>
    </apex:pageBlock>
    <apex:outputPanel id="acclist">
    <apex:pageBlock title="Oportunidades recentes">
        <apex:pageBlockButtons location="top">
        <apex:form >
            <!-- <apex:commandButton value="Nova" action="{!NuevaFact}"></apex:commandButton> -->
        </apex:form>
        </apex:pageBlockButtons>
        <apex:form >
            <apex:actionStatus startText="Consultando..." id="status2"/>
            <div align="right" style="display:{!IF(NOT(ISNULL(result)),'block','none')}">
                <font size="1pt">Página&nbsp;<apex:outputLabel value="{!PageNumber}"/>&nbsp;de&nbsp;<apex:outputLabel value="{!totalPageNumber}"/>&nbsp;&nbsp;&nbsp;&nbsp;</font>
                <apex:commandButton status="status2" value="<<" action="{!firstBtnClick}" disabled="{!firstButtonDisabled}" rerender="acclist"></apex:commandButton>
                <apex:commandButton status="status2" value="Anterior" action="{!previousBtnClick}" disabled="{!previousButtonEnabled}" rerender="acclist"></apex:commandButton>
                <apex:commandButton status="status2" value="Mais" action="{!nextBtnClick}" rerender="acclist" disabled="{!nextButtonDisabled}" ></apex:commandButton>
                <apex:commandButton status="status2" value=">>" action="{!lastBtnClick}" disabled="{!lastButtonDisabled}" rerender="acclist"></apex:commandButton>
            </div>
            <apex:pageBlockTable value="{!result}" var="item" id="resultPanel">
                <apex:column headerValue="Nome da oportunidade">
                    <apex:outputLink value="../{!item.id}" id="elLink">
                        <apex:outputText value="{!item.name}"/>
                    </apex:outputLink>
                </apex:column>
                <apex:column headerValue="Nro de Pedido SAP">
                    <apex:outputText value="{!item.Nro_Pedido_SAP__c}"/>
                </apex:column>
                <apex:column headerValue="Nome da conta">
                    <apex:outputLink value="../{!item.Account.Id}" id="elLinkAcc">
                        <apex:outputText value="{!item.Account.Name}"/>
                    </apex:outputLink>
                </apex:column>
                <apex:column headerValue="Responsavel">
                    <apex:OutputText value="{!item.Account.Responsavel__c}"/>
                </apex:column>
                <apex:column headerValue="Data de fechamento">
                    <apex:OutputText value="{!day(item.CloseDate)}/{!month(item.CloseDate)}/{!year(item.CloseDate)}"/>
                </apex:column>
                <apex:column headerValue="Relatorio">
                    <apex:outputLink value="../{!item.Relatorio_Relacionado__c}" id="elLinkRel">
                        <apex:outputText value="{!item.Relatorio_Relacionado__r.Name}"/>
                    </apex:outputLink>
                </apex:column>
                <apex:column headerValue="Tipo de Registro">
                    <apex:OutputText value="{!item.RecordType.Name}"/>
                </apex:column>
                <apex:column headerValue="Data da última modificação">
                    <!--<apex:OutputText value="{!day(item.LastModifiedDate)}/{!month(item.LastModifiedDate)}/{!year(item.LastModifiedDate)}"/>-->
                    <apex:OutputText value="{0,date,MM'/'dd'/'yyyy hh:mm:ss}"><apex:param value="{!item.LastModifiedDate}"/></apex:outputText>
                </apex:column>
<!--                <apex:column headerValue="Fase"><apex:OutputText value="{!item.StageName}"/></apex:column>
                <apex:column headerValue="Safra"><apex:OutputText value="{!item.Safra__c}"/></apex:column>
                <apex:column headerValue="Número"><apex:OutputText value="{!item.Numero_del__c}"/></apex:column>-->
            </apex:pageBlockTable>
        </apex:form>
    </apex:pageBlock>
    </apex:outputPanel>
</apex:page>