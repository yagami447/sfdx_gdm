<apex:page Controller="anexosController" title="Anexos" tabStyle="Opportunity">
    <apex:sectionHeader title="Lista de Anexos"></apex:sectionHeader>
    <apex:pageBlock title="Pesquisa de Anexos">
        <apex:form >
            <apex:outputLabel value="Tipo de Anexo:  "></apex:outputLabel> 
            <apex:selectList value="{!anexo}" size="1" required="true"><apex:selectOptions value="{!TiposAnexos}"/></apex:selectList>
            <apex:outputLabel value="Etapa:  "></apex:outputLabel> 
            <apex:selectList value="{!etapaAnexo}" size="1" required="true"><apex:selectOptions value="{!EtapasAnexos}"/></apex:selectList>
            <apex:outputLabel value="Critério:  "></apex:outputLabel>
            <apex:inputText value="{!searchTextAnexo}"></apex:inputText>            
            <apex:commandButton action="{!listarAnexos}" value="Pesquisar" id="searchBtn" rerender="anexoslist" status="status"/>
            <apex:actionStatus startText="Consultando..." id="status"/>
        </apex:form>
    </apex:pageBlock>
    <apex:outputPanel id="anexoslist">
    <apex:pageBlock title="">
        <apex:pageBlockButtons location="top">
        <apex:form >
            <!-- <apex:commandButton value="Nova" action="{!NuevaFact}"></apex:commandButton> -->
        </apex:form>
        </apex:pageBlockButtons>
        <apex:form >
            <apex:actionStatus startText="Consultando..." id="status2"/>
            <apex:pageBlockTable value="{!resultAnexos}" var="item" id="resultPanel">
                <apex:column headerValue="Nome da oportunidade">
                    <apex:outputLink value="../{!item.id}" id="elLink">
                        <apex:outputText value="{!item.name}"/>
                    </apex:outputLink>
                </apex:column>
                <apex:column headerValue="Nome da conta">
                    <apex:outputLink value="../{!item.Account.Id}" id="elLinkAcc">
                        <apex:outputText value="{!item.Account.Name}"/>
                    </apex:outputLink>
                </apex:column>
                <apex:column headerValue="Responsavel">
                    <apex:OutputText value="{!item.Account.Responsavel__c}"/>
                </apex:column>
                <apex:column headerValue="Cidade">
                    <apex:OutputField value="{!item.VB_Cidade__c}"/>
                </apex:column>
                <apex:column headerValue="Estado de Produccion">
                    <apex:OutputField value="{!item.Estado_de_produccion__c}"/>
                </apex:column>
                <apex:column headerValue="Data de fechamento">
                    <apex:OutputText value="{!day(item.CloseDate)}/{!month(item.CloseDate)}/{!year(item.CloseDate)}"/>
                </apex:column>
                <apex:column headerValue="Tipo de Registro">
                    <apex:OutputText value="{!item.RecordType.Name}"/>
                </apex:column>
                <apex:column headerValue="Etapa">
                    <apex:OutputText value="{!item.StageName}"/>
                </apex:column>
                <apex:column headerValue="Data da última modificação">                    
                    <apex:OutputText value="{0,date,MM'/'dd'/'yyyy hh:mm:ss}"><apex:param value="{!item.LastModifiedDate}"/></apex:outputText>
                </apex:column>
            </apex:pageBlockTable>
        </apex:form>
    </apex:pageBlock>
    </apex:outputPanel>
</apex:page>