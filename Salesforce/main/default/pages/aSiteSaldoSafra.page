<apex:page id="SaldoSafraId" showheader="false" standardstylesheets="false" cache="false" controller="aSiteSaldoSafraController" action="{!validate}">
    <apex:composition template="{!$Site.Template}">
        <apex:includescript value="{!$Resource.styleClassContainer.css}" />
        <apex:define name="body">
            <style>
                .selected {
                background: rgba(38,185,154,.16);
                border-color: rgba(221,221,221,0.780392);
                }
            </style>
            <body class="nav-md footer_fixed">
                <center>
                    <br />
                    <br />
                    <apex:panelgrid cellpadding="0" cellspacing="0" bgcolor="white" columns="1" style="margin:20px; width: 80%;">
                        <apex:form id="profileForm">
                            <div role="main">
                                <div class="x_panel">
                                    <div style="padding:15px;">
                                        <div class="x_content">
                                            <div role="tabpanel" class="tab-pane" id="tab_items_new" aria-labelledby="profile-tab" align="center">
                                                <apex:pageblock >
                                                    <table width="90%" class="data table table-striped no-margin"
                                                           style="background: rgba(240, 240, 240, 90); border: 1px solid gray; border-radius: 3px">
                                                        <tr>
                                                            <td width="15%" />
                                                            <td width="15%" />
                                                            <td width="40%">
                                                                <center><b><apex:outputtext value="Resumo" style="font-size:25px" /></b></center>
                                                            </td>
                                                            <td width="30%" />
                                                        </tr>
                                                        <tr>                                                        
                                                            <td width="15%">
                                                                <apex:outputtext rendered="{!renderSaldo}" value="Saldo inicial: " />
                                                            </td>
                                                            <td width="15%" align="right">                                                         
                                                                <apex:outputField value="{!saldoActual.Saldo__c}" rendered="{!renderSaldo}"/>
                                                            </td>
                                                            <td width="40%" />
                                                            <td width="30%">
                                                                <apex:outputtext value="Safra: {!safraActual}" />
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td width="15%">
                                                                <apex:outputtext rendered="{!renderSaldo}" value="Saldo atual: " />
                                                                <apex:outputtext rendered="{!!renderSaldo}" value="Não há saldo para esta conta" />
                                                            </td>
                                                            <td width="15%" align="right">                                                            
                                                                <apex:outputField value="{!saldoActual.Saldo_Disponible__c}" rendered="{!renderSaldo}"/>
                                                            </td>
                                                            <td width="40%" />
                                                            <td width="30%">
                                                                <apex:outputtext rendered="false" value="Estado: {!saldoActual.Estado__c}" />
                                                            </td> 
                                                        </tr>
                                                        
                                                        <tr>
                                                            <td width="15%">
                                                                <apex:outputtext rendered="{!renderSaldo}" value="Monto minimo para Brindes: " />
                                                            </td>
                                                            <td width="15%" align="right">                                                            
                                                                <apex:outputField value="{!montoBrindes.Amount}" rendered="{!renderSaldo}"/>
                                                            </td>                                                            
                                                        </tr>
                                                    </table>
                                                </apex:pageblock>
                                            </div>
                                        </div>
                                        <br />
                                        <br />
                                        <apex:outputPanel id="eventosTable">
                                            <apex:pageblock >
                                                <center style="margin: 30px"><b><apex:outputText value="Eventos Royalties" style="font-size:25px;"/></b></center>
                                                <apex:datatable headerClass="center" styleclass="data table table-bordered table-striped no-margin" value="{!eventos}" var="evento" width="90%" style="padding:30px;" align="center">
                                                    <apex:column headervalue="Tipo" value="{!evento.Accion__c}" width="15%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " />
                                                    <apex:column headervalue="Nome" value="{!evento.Name}" width="20%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " />                                           
                                                    <apex:column headervalue="Data" value="{!evento.Fecha__c}" width="10%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " />
                                                    <apex:column headervalue="Status" value="{!evento.Estado__c}" width="15%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " />                                               
                                                    <apex:column headerValue="Valor" width="10%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px;">
                                                        <apex:outputField value="{!evento.Valor__c}" rendered="{!renderSaldo}"/>
                                                    </apex:column>
                                                    <apex:column headerValue="Ação" width="30%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px;">
                                                        <apex:commandLink value="Ver Itens " action="{!verItems}" reRender="profileForm">
                                                            <apex:param value="{!evento.id}" assignTo="{!eventoId}" name="toSelect"/>
                                                        </apex:commandLink>
                                                        <apex:commandLink value=" | Editar " action="{!editar}" rendered="{!evento.Estado__c == 'Edicion'}">
                                                            <apex:param value="{!evento.id}" assignTo="{!eventoId}" name="toSelect"/>
                                                        </apex:commandLink>
                                                        <apex:commandLink value=" | Enviar para aprovação" action="{!enviarParaAprobacion}" rendered="{!evento.Estado__c == 'Edicion'}" oncomplete="mostrarMsj();" reRender="profileForm" >
                                                            <apex:param value="{!evento.id}" assignTo="{!eventoId}" name="toSelect"/>
                                                        </apex:commandLink>
                                                    </apex:column>
                                                </apex:datatable>
                                            </apex:pageblock>
                                        </apex:outputPanel>
                                        <br/>                                                                        
                                        <apex:pageBlock id="itemTable">
                                            <center style="margin: 30px"><b><apex:outputText value="Itens" style="font-size:25px;" rendered="{!itemsDelEvento.size > 0 }"/></b></center>                                            
                                            <apex:pageBlockTable value="{!itemsDelEvento}" var="item" rendered="{!itemsDelEvento.size > 0 }" headerClass="center" styleclass="data table table-bordered table-striped no-margin" width="90%" style="padding:30px;" align="center">
                                                <apex:column headerValue="Tipo" width="10%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; ">
                                                    <apex:outputField styleClass="form-control" value="{!item.Tipo__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="Item" width="14%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; ">
                                                    <apex:outputField styleClass="form-control" value="{!item.Item__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="Data" width="7%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Reembolso'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Data__c}"/>                                                   
                                                </apex:column>
                                                <apex:column headerValue="Comentário" width="21%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; ">                                        
                                                    <apex:outputField styleClass="form-control" value="{!item.Comentario__c}"/>    
                                                </apex:column>
                                                <apex:column headerValue="Modelo" width="1%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Modelo__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="Tamanho" width="1%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Tamanio__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="Cultivar" width="17%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Variedad__r.Name}"/>
                                                </apex:column>
                                                <apex:column headerValue="Quantidade" width="2%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Quantidade__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="UF" width="6%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.UF__r.Name}"/>
                                                </apex:column>
                                                <apex:column headerValue="Cidade" width="14%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px; " rendered="{!tipoSel == 'Pedido'}">
                                                    <apex:outputField styleClass="form-control" value="{!item.Cidade__c}"/>
                                                </apex:column>
                                                <apex:column headerValue="Valor unitário" width="8%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px;" rendered="{!tipoSel == 'Pedido'}">                                                                                     
                                                    <apex:outputField styleClass="form-control" value="{!item.Valor_Unitario__c}" rendered="{!renderSaldo}"/>
                                                </apex:column>
                                                <apex:column headerValue="Valor total" width="19%" style="text-align: center; border-bottom: 1px solid #ddd; padding: 5px;">                                                                                     
                                                    <apex:outputField styleClass="form-control" value="{!item.Valor__c}" rendered="{!renderSaldo}"/>
                                                </apex:column>
                                            </apex:pageBlockTable>
                                        </apex:pageBlock>
                                        <br/>
                                        <div class="form-group top_search ">
                                            <div class="btn-group" data-toggle="buttons" style="width:100%">
                                                <center>
                                                    <apex:commandbutton action="{!goToCreateRoyaltyEventPedido}"
                                                                        value="Adicionar Ações - Pedidos" styleclass="btn btn-success"
                                                                        disabled="{!!activeNuevoEvento}" oncomplete="mostrarMsj();" rerender="profileForm"/> &nbsp;&nbsp;
                                                    <apex:commandbutton action="{!goToCreateRoyaltyEventReembolso}"
                                                                        value="Adicionar Ações - Reembolso" styleclass="btn btn-success"
                                                                        disabled="{!!activeNuevoEvento}" oncomplete="mostrarMsj();" rerender="profileForm"/>                    
                                                </center>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <apex:actionfunction action="{!goToCreateRoyaltyEventPedido}" name="goToCreateRoyaltyEventP" />
                            <apex:actionfunction action="{!goToCreateRoyaltyEventReembolso}" name="goToCreateRoyaltyEventR" />
                            
                            <script type="text/javascript">
                                function mostrarMsj(){
                                    if ('{!mensaje}' != null && '{!mensaje}' != ''){
                                        alert('{!SUBSTITUTE(mensaje, "|", "\n")}');                                                        
                                    }
                                }
                            </script>
                            
                        </apex:form>
                    </apex:panelgrid>
                </center>
            </body>
            <br />
        </apex:define>
    </apex:composition>
    
    <style>
        .center{
        text-align: center !important;
        }
    </style>
</apex:page>